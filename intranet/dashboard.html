<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Dashboard - Roblox Health Ministry</title>
<meta name="viewport" content="width=device-width, initial-scale=1">
<link rel="stylesheet" href="../assets/css/nhsuk.min.css">
<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
<style>
.cards { display:flex; flex-wrap:wrap; gap:1rem; margin-top:1rem; }
.card { flex:1 1 200px; padding:1rem; border-radius:8px; color:white; font-weight:bold; text-align:center; display:flex; align-items:center; justify-content:center; gap:0.5rem;}
.Critical { background-color:#d9534f; }
.Stable { background-color:#5cb85c; }
.Recovering { background-color:#f0ad4e; }
.Total { background-color:#0275d8; }
.links { margin-top:1rem; display:flex; gap:1rem; flex-wrap:wrap; }
.recent { margin-top:2rem; }
.recent h2 { margin-bottom:0.5rem; }
.recent ul { list-style:none; padding-left:0; }
.recent li { padding:0.25rem 0; border-bottom:1px solid #ddd; }
canvas { max-width:600px; margin-top:2rem; }
.breadcrumb { font-size:0.9rem; margin-top:0.5rem; margin-bottom:1rem; }
.breadcrumb a { color:#005eb8; text-decoration:none; }
.breadcrumb a:hover { text-decoration:underline; }
.card i { font-style:normal; font-size:1.5rem; }
</style>
</head>
<body class="nhsuk-body nhsuk-clearfix">

<header class="nhsuk-header">
  <div class="nhsuk-width-container nhsuk-header__container">
    <span class="nhsuk-header__logo-text">Roblox Health Ministry</span>
    <nav class="nhsuk-header__navigation" aria-label="Primary navigation">
      <ul class="nhsuk-header__navigation-list">
        <li class="nhsuk-header__navigation-item"><a class="nhsuk-header__navigation-link" href="dashboard">Dashboard</a></li>
        <li class="nhsuk-header__navigation-item"><a class="nhsuk-header__navigation-link" href="patients">Patients</a></li>
        <li class="nhsuk-header__navigation-item"><a class="nhsuk-header__navigation-link" href="add-patient">Add Patient</a></li>
        <li class="nhsuk-header__navigation-item"><a class="nhsuk-header__navigation-link" href="login">Logout</a></li>
      </ul>
    </nav>
  </div>
</header>

<div class="nhsuk-width-container">
<main class="nhsuk-main-wrapper">

<div class="breadcrumb">
<a href="dashboard.html">Dashboard</a>
</div>

<h1 class="nhsuk-heading-xl">Dashboard</h1>

<div class="cards">
  <div class="card Total"> <span id="totalPatients">Total Patients: 0</span></div>
  <div class="card Critical"> <span id="criticalPatients">Critical: 0</span></div>
  <div class="card Stable"> <span id="stablePatients">Stable: 0</span></div>
  <div class="card Recovering"> <span id="recoveringPatients">Recovering: 0</span></div>
</div>

<div class="links">
  <a class="nhsuk-button nhsuk-button--secondary" href="patients">View All Patients</a>
  <a class="nhsuk-button nhsuk-button--primary" href="add-patient">Add New Patient</a>
</div>

<div class="recent">
  <h2>Recently Added Patients</h2>
  <ul id="recentPatients"></ul>
</div>

<canvas id="statusChart"></canvas>

<script>
// Load patients from localStorage
const patients = JSON.parse(localStorage.getItem('patients')||'[]');

// Summary counts
function updateDashboard() {
  const counts={Critical:0,Stable:0,Recovering:0};
  patients.forEach(p=>{ if(counts[p.status]!==undefined) counts[p.status]++; });

  document.getElementById('totalPatients').textContent=`Total Patients: ${patients.length}`;
  document.getElementById('criticalPatients').textContent=`Critical: ${counts.Critical}`;
  document.getElementById('stablePatients').textContent=`Stable: ${counts.Stable}`;
  document.getElementById('recoveringPatients').textContent=`Recovering: ${counts.Recovering}`;

  const recentList=document.getElementById('recentPatients');
  recentList.innerHTML='';
  [...patients].reverse().slice(0,5).forEach(p=>{
    const li=document.createElement('li');
    li.textContent=`${p.name} | Room: ${p.room} | Status: ${p.status}`;
    recentList.appendChild(li);
  });

  statusChart.data.datasets[0].data=[counts.Critical, counts.Stable, counts.Recovering];
  statusChart.update();
}

// Chart.js setup
const ctx=document.getElementById('statusChart').getContext('2d');
const statusChart=new Chart(ctx,{type:'bar',data:{labels:['Critical','Stable','Recovering'],datasets:[{label:'Patients',data:[0,0,0],backgroundColor:['#d9534f','#5cb85c','#f0ad4e']}]},options:{responsive:true,plugins:{legend:{display:false},title:{display:true,text:'Patient Status Overview'}},scales:{y:{beginAtZero:true,precision:0}}}});

updateDashboard();
</script>

</main>
</div>

<footer class="nhsuk-footer">
<div class="nhsuk-width-container">
<p class="nhsuk-body-s">Â© Roblox Health Ministry</p>
</div>
</footer>

</body>
</html>
